<!DOCTYPE HTML>
<html lang="en">

<head>
    <title>Object Detection Hub</title>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="styles.css" />

    <style>
        /* General Styles */
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f4f4f4;
            color: #333;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        /* Header */
        header {
            background-color: #007bff;
            color: white;
            padding: 20px;
            text-align: center;
            width: 100%;
        }

        header h1 {
            margin: 0;
            font-size: 2.5rem;
        }

        header p {
            margin-top: 10px;
            font-size: 1.2rem;
        }

        /* Main Content */
        main {
            background: white;
            border-radius: 10px;
            margin: 20px;
            padding: 20px;
            width: 90%;
            max-width: 600px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        h2 {
            text-align: center;
            margin-bottom: 15px;
        }

        /* Upload Section */
        .upload-section {
            text-align: center;
            margin-bottom: 20px;
        }

        .upload-area {
            border: 2px dashed #007bff;
            padding: 20px;
            border-radius: 10px;
            position: relative;
            cursor: pointer;
        }

        .upload-area:hover {
            background-color: #f0f8ff;
        }

        .upload-area input {
            opacity: 0;
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            cursor: pointer;
        }

        .preview {
            margin-top: 15px;
        }

        .preview img,
        .preview video {
            max-width: 100%;
            border-radius: 10px;
            display: none;
        }

        /* Model Selection */
        .model-selection {
            margin-bottom: 20px;
        }

        .model-selection label {
            display: block;
            margin: 10px 0;
            font-size: 1rem;
            cursor: pointer;
        }

        .model-selection input {
            margin-right: 10px;
        }

        /* Submit Button */
        button {
            width: 100%;
            padding: 15px;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 5px;
            font-size: 1.2rem;
            cursor: pointer;
        }

        button:hover {
            background-color: #0056b3;
        }
    </style>
</head>

<body>
    <!-- Header -->
    <header>
        <h1>{{ title }} Hub</h1>
        <p>Upload an image or video, select models, and detect objects seamlessly.</p>
    </header>

    <!-- Form Section -->
    <main>
        <form action="/detect" method="POST" enctype="multipart/form-data">
            <!-- Upload Section -->
            <div class="upload-section">
                <h2>Upload Your File</h2>
                <div class="upload-area" id="uploadArea">
                    <p>Drop your file here or click to upload</p>
                    <input type="file" name="file_url" id="fileInput" accept="image/*,video/*" required>
                    <div class="preview">
                        <img id="imagePreview" alt="Image Preview">
                        <video id="videoPreview" controls></video>
                    </div>
                </div>
            </div>

            <!-- Model Selection -->
            <div class="model-selection">
                <h2>Select Detection Models</h2>
                <label><input type="checkbox" id="selectAll"> Select All</label>
                <div id="modelList">
                    {% for model in models %}
                        <label>{{ loop.index }}. <input type="checkbox" class="model-checkbox" name="models" value="{{model}}">{{model.title()}}</label>
                    {% endfor %}
                </div>
            </div>

            <!-- Submit Button -->
            <button type="submit">{{title}}</button>
        </form>
    </main>

    <h4><a href="/">Home</a></h4>
    <!-- Scripts -->
    <script src="script.js"></script>
    <script>
        const fileInput = document.getElementById('fileInput');
        const imagePreview = document.getElementById('imagePreview');
        const videoPreview = document.getElementById('videoPreview');

        fileInput.addEventListener('change', function (event) {
            const file = event.target.files[0];

            if (file) {
                const fileType = file.type;

                if (fileType.startsWith('image/')) {
                    const reader = new FileReader();
                    reader.onload = function (e) {
                        imagePreview.src = e.target.result;
                        imagePreview.style.display = 'block';
                        videoPreview.style.display = 'none';
                    };
                    reader.readAsDataURL(file);
                } else if (fileType.startsWith('video/')) {
                    const videoURL = URL.createObjectURL(file);
                    videoPreview.src = videoURL;
                    videoPreview.style.display = 'block';
                    imagePreview.style.display = 'none';
                }
            } else {
                imagePreview.style.display = 'none';
                videoPreview.style.display = 'none';
            }
        });

        // Select All Checkbox Logic
        document.getElementById('selectAll').addEventListener('change', function () {
            const checkboxes = document.querySelectorAll('.model-checkbox');
            checkboxes.forEach(checkbox => checkbox.checked = this.checked);
        });

        // Sync "Select All" when individual checkboxes are clicked
        document.querySelectorAll('.model-checkbox').forEach(checkbox => {
            checkbox.addEventListener('change', function () {
                const allChecked = [...document.querySelectorAll('.model-checkbox')].every(cb => cb.checked);
                document.getElementById('selectAll').checked = allChecked;
            });
        });
    </script>
</body>

</html>